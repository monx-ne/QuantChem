<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Temas selectos de Química Cuántica - 2&nbsp; Método de Hartree-Fock</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./DFT.html" rel="next">
<link href="./intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Método de Hartree-Fock</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Temas selectos de Química Cuántica</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Prefacio</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./H-F.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Método de Hartree-Fock</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DFT.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Teoría de los funcionales de la densidad (DFT)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#definir-sistema-de-estudio-y-base" id="toc-definir-sistema-de-estudio-y-base" class="nav-link active" data-scroll-target="#definir-sistema-de-estudio-y-base"><span class="toc-section-number">2.0.1</span>  Definir sistema de estudio y base</a></li>
  <li><a href="#definir-integrales" id="toc-definir-integrales" class="nav-link" data-scroll-target="#definir-integrales"><span class="toc-section-number">2.0.2</span>  Definir integrales</a></li>
  <li><a href="#calcular-matriz-de-fock-textbff" id="toc-calcular-matriz-de-fock-textbff" class="nav-link" data-scroll-target="#calcular-matriz-de-fock-textbff"><span class="toc-section-number">2.0.3</span>  Calcular matriz de Fock <span class="math inline">\(\textbf{F}\)</span></a></li>
  <li><a href="#transformar-textbff-a-matriz-textbff" id="toc-transformar-textbff-a-matriz-textbff" class="nav-link" data-scroll-target="#transformar-textbff-a-matriz-textbff"><span class="toc-section-number">2.0.4</span>  Transformar <span class="math inline">\(\textbf{F}\)</span> a matriz <span class="math inline">\(\textbf{F}'\)</span></a></li>
  <li><a href="#diagonalizar-matriz-textbff-para-obtener-pmbepsilon-y-textbfc" id="toc-diagonalizar-matriz-textbff-para-obtener-pmbepsilon-y-textbfc" class="nav-link" data-scroll-target="#diagonalizar-matriz-textbff-para-obtener-pmbepsilon-y-textbfc"><span class="toc-section-number">2.0.5</span>  Diagonalizar matriz <span class="math inline">\(\textbf{F}'\)</span> para obtener <span class="math inline">\(\pmb{\epsilon}\)</span> y <span class="math inline">\(\textbf{C}'\)</span></a></li>
  <li><a href="#transformar-textbfc-a-textbfc" id="toc-transformar-textbfc-a-textbfc" class="nav-link" data-scroll-target="#transformar-textbfc-a-textbfc"><span class="toc-section-number">2.0.6</span>  Transformar <span class="math inline">\(\textbf{C}'\)</span> a <span class="math inline">\(\textbf{C}\)</span></a></li>
  <li><a href="#comparar-parámetros-para-revisar-convergencia" id="toc-comparar-parámetros-para-revisar-convergencia" class="nav-link" data-scroll-target="#comparar-parámetros-para-revisar-convergencia"><span class="toc-section-number">2.0.7</span>  Comparar parámetros para revisar convergencia</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Método de Hartree-Fock</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Las ecuaciones de Hartree-Fock son ecuaciones no lineares que pueden ser resueltas con los métodos numéricos apropiados. Sin embargo, en 1951, C.C.J. Roothan demostró que utilizando el método de LCAO, las ecuaciones de Fock se simplifican reformulándose como matrices [1][2].</p>
<p>En este ejemplo, se resolverá la ecuación de Roothan <span class="math inline">\(\textbf{F}\textbf{C}=\textbf{S}\textbf{C}\pmb{\epsilon}\)</span> para el ión de hidruro de helio (<span class="math inline">\(HeH^{+}\)</span>) siguiendo el algoritmo esquematizado en la siguiente figura[3]:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/im22.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">1</figcaption><p></p>
</figure>
</div>
<section id="definir-sistema-de-estudio-y-base" class="level3" data-number="2.0.1">
<h3 data-number="2.0.1" class="anchored" data-anchor-id="definir-sistema-de-estudio-y-base"><span class="header-section-number">2.0.1</span> Definir sistema de estudio y base</h3>
<p>El presente proyecto se realizó bajo el sistema de referencia: <img src="images/im11.png" class="img-fluid" alt="1"></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span><span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.linalg <span class="im">import</span> inv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dHHe<span class="op">=</span> <span class="fl">1.5117</span> <span class="co">#a.u.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>rR1 <span class="op">=</span> <span class="dv">0</span> <span class="co">#Distancia del origen a núcleo H</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>rR2 <span class="op">=</span> <span class="fl">1.5117</span>  <span class="co">#Distancia del origen a núcleo He</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ZH<span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>ZHe<span class="op">=</span><span class="dv">2</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> <span class="dv">2</span> <span class="co">#Número de átomos en molécula</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Utilizaremos como funciones base combinaciones lineares de funciones Gaussianas (STO-1G, específicamente). Esto facilita la evaluación de las integrales correspondientes y hará posible utilizar directamente las expresiones ya calculadas en [4].</p>
<p>Las funciones base propuestas son funciones Gaussianas contraídas (CGF, por sus siglas en inglés) y tinene la forma:</p>
<p><span class="math inline">\(\phi^{CGF}_{1s}= \sum^3_{p=1} d_p \phi^{GF}_{1s}(\alpha_p, \textbf{r}-\textbf{R}_A )\)</span></p>
<p>donde <span class="math inline">\(\phi^{GF}_{1s}(\alpha_p, \textbf{r}-\textbf{R}_A ) = \left( \frac{2 \alpha}{\pi} \right)^{3/4} \mathrm{e}^{-\alpha_p|\textbf{r}-\textbf{R}_A|^2}\)</span></p>
<p>Generaremos el diccionario <span class="math inline">\(BasisDat\)</span> para recopilar los datos de los coeficientes de contracción (<span class="math inline">\(d_p\)</span>) y exponenciales (<span class="math inline">\(\alpha_p\)</span>) de cada átomo (<span class="math inline">\(A\)</span>) de la molécula [3]. Este diccionario puede expandirse incluyendo los datos de otras bases[5].</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>BasisDat<span class="op">=</span> {<span class="st">'H'</span>: {<span class="st">'STO-1G'</span>:{<span class="st">'exp'</span>:<span class="fl">0.4166</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'coef'</span>:<span class="fl">0.3996</span>}},               </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">'He'</span>: {<span class="st">'STO-1G'</span>:{<span class="st">'exp'</span>:<span class="fl">0.7739</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'coef'</span>:<span class="fl">0.5881</span>}}}</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>dH<span class="op">=</span> BasisDat[<span class="st">'H'</span>][<span class="st">'STO-1G'</span>][<span class="st">'coef'</span>]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>αH<span class="op">=</span>BasisDat[<span class="st">'H'</span>][<span class="st">'STO-1G'</span>][<span class="st">'exp'</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>dHe <span class="op">=</span>BasisDat[<span class="st">'He'</span>][<span class="st">'STO-1G'</span>][<span class="st">'coef'</span>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>αHe <span class="op">=</span> BasisDat[<span class="st">'He'</span>][<span class="st">'STO-1G'</span>][<span class="st">'exp'</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span>[αH,αHe]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>ds<span class="op">=</span> [dH,dHe]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="definir-integrales" class="level3" data-number="2.0.2">
<h3 data-number="2.0.2" class="anchored" data-anchor-id="definir-integrales"><span class="header-section-number">2.0.2</span> Definir integrales</h3>
<section id="integrales-de-traslape-s_mu-nu" class="level4" data-number="2.0.2.1">
<h4 data-number="2.0.2.1" class="anchored" data-anchor-id="integrales-de-traslape-s_mu-nu"><span class="header-section-number">2.0.2.1</span> Integrales de traslape <span class="math inline">\(S_{\mu \nu}\)</span></h4>
<p>La integral de traslape para el orbital 1s de H (<span class="math inline">\(\mu\)</span>) y el orbital 1s de He (<span class="math inline">\(\nu\)</span>) está definida como:</p>
<p>$_{} = ^{CGF *}<em>{} ^{CGF}</em>{} $</p>
<p>Siendo cada elemento <span class="math inline">\(S_{\mu\nu}\)</span> el ya calculado en la ecuación (A9) de [4]:</p>
<p><span class="math inline">\(S_{pq} = \left( \frac{\pi}{\alpha_{p \mu} + \alpha_{q \nu}} \right)^{3/2} \mathrm{exp}[ -\frac{\alpha_{p \mu} \alpha_{q \nu}}{\alpha_{p \mu}+ \alpha_{q \nu}} |\textbf{R}_A-\textbf{R}_B|^2]\)</span></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> zeros((dim,dim))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> q <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> alphas[p]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        nu <span class="op">=</span> alphas[q]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        N<span class="op">=</span>(<span class="dv">4</span><span class="op">*</span>mu<span class="op">*</span>nu<span class="op">/</span>(pi<span class="op">**</span><span class="dv">2</span>))<span class="op">**</span><span class="fl">0.75</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p<span class="op">==</span>q:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            S[p,q] <span class="op">=</span> (pi<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">**</span>(<span class="fl">1.5</span>)<span class="op">*</span>N<span class="op">*</span>exp(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>((mu<span class="op">*</span>nu)<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">*</span>(rR1)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>            S[p,q]<span class="op">=</span>(pi<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">**</span>(<span class="fl">1.5</span>)<span class="op">*</span>N<span class="op">*</span>exp(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>((mu<span class="op">*</span>nu)<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">*</span>(rR2)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(mu,nu,N)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(S)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1.         0.50173931]
 [0.50173931 1.        ]]</code></pre>
</div>
</div>
</section>
<section id="definir-hathcore_mu-nu" class="level4" data-number="2.0.2.2">
<h4 data-number="2.0.2.2" class="anchored" data-anchor-id="definir-hathcore_mu-nu"><span class="header-section-number">2.0.2.2</span> Definir <span class="math inline">\(\hat{H}^{core}_{\mu \nu}\)</span></h4>
<p>El <span class="math inline">\(\hat{H}^{core}_{\mu \nu}\)</span> puede definirse como:</p>
<p><span class="math inline">\(\hat{H}^{core}_{\mu \nu} = \textbf{T}_{\mu \nu} + \textbf{V}^{nucH}_{\mu \nu} + \textbf{V}^{nucHe}_{\mu \nu}\)</span></p>
<p>donde <span class="math inline">\(\textbf{T}_{\mu \nu}\)</span> es la matriz de la energía cinética de un electrón y <span class="math inline">\(\textbf{V}^{nucC}_{\mu \nu}\)</span> es la matriz correspondiente al potencial de atracción entre un electrón y el núcleo <span class="math inline">\(C\)</span>. Cada término es calculado de manera similar a <span class="math inline">\(\mathbf{S}_{\mu \nu}\)</span>, siendo los correspondientes términos <span class="math inline">\(T_{pq}\)</span>, <span class="math inline">\(V^H_{pq}\)</span> y <span class="math inline">\(V^{He}_{pq}\)</span> aquellos calculados en (A11) y (A33) en [4].</p>
<section id="integral-de-energía-cinética-de-un-electrón-t_mu-nu" class="level5" data-number="2.0.2.2.1">
<h5 data-number="2.0.2.2.1" class="anchored" data-anchor-id="integral-de-energía-cinética-de-un-electrón-t_mu-nu"><span class="header-section-number">2.0.2.2.1</span> Integral de energía cinética de un electrón <span class="math inline">\(T_{\mu \nu}\)</span></h5>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> zeros((dim,dim))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> q <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> alphas[p]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        nu <span class="op">=</span> alphas[q]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        N<span class="op">=</span>(<span class="dv">4</span><span class="op">*</span>mu<span class="op">*</span>nu<span class="op">/</span>(pi<span class="op">**</span><span class="dv">2</span>))<span class="op">**</span><span class="fl">0.75</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p<span class="op">==</span>q:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            T[p,q]<span class="op">=</span>N<span class="op">*</span>mu<span class="op">*</span>nu<span class="op">/</span>(mu<span class="op">+</span>nu)<span class="op">*</span>(<span class="fl">3.0</span><span class="op">-</span><span class="fl">2.0</span><span class="op">*</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR1<span class="op">*</span>rR2)<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">*</span>(pi<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">**</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>exp(<span class="op">-</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR1<span class="op">*</span>rR2)<span class="op">/</span>(mu<span class="op">+</span>nu))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            T[p,q]<span class="op">=</span>N<span class="op">*</span>mu<span class="op">*</span>nu<span class="op">/</span>(mu<span class="op">+</span>nu)<span class="op">*</span>(<span class="fl">3.0</span><span class="op">-</span><span class="fl">2.0</span><span class="op">*</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR2<span class="op">*</span>rR2)<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">*</span>(pi<span class="op">/</span>(mu<span class="op">+</span>nu))<span class="op">**</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>exp(<span class="op">-</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR2<span class="op">*</span>rR2)<span class="op">/</span>(mu<span class="op">+</span>nu))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.6249     0.23945188]
 [0.23945188 1.16085   ]]</code></pre>
</div>
</div>
</section>
<section id="integrales-de-energía-potencial-de-un-electrón-y-un-núcleo-vnuc_mu-nu" class="level5" data-number="2.0.2.2.2">
<h5 data-number="2.0.2.2.2" class="anchored" data-anchor-id="integrales-de-energía-potencial-de-un-electrón-y-un-núcleo-vnuc_mu-nu"><span class="header-section-number">2.0.2.2.2</span> Integrales de energía potencial de un electrón y un núcleo <span class="math inline">\(V^{nuc}_{\mu \nu}\)</span></h5>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">###Definición de funciones F_0 y Rp como se realiza en [6]</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> F0(t):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Función F para orbital 1s</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (t<span class="op">&lt;</span><span class="fl">1e-6</span>):</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">1.0</span><span class="op">-</span>t<span class="op">/</span><span class="fl">3.0</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.5</span><span class="op">*</span>(pi<span class="op">/</span>t)<span class="op">**</span><span class="fl">0.5</span><span class="op">*</span>erf(t<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> erf(t):</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Aproximación para la función de error</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> <span class="fl">0.3275911</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> [<span class="fl">0.254829592</span>,<span class="op">-</span><span class="fl">0.284496736</span>,<span class="fl">1.421413741</span>,<span class="op">-</span><span class="fl">1.453152027</span>,<span class="fl">1.061405429</span>]</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>P<span class="op">*</span>t)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    Tn<span class="op">=</span>T</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    Poly <span class="op">=</span> A[<span class="dv">0</span>]<span class="op">*</span>Tn</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">5</span>):</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        Tn<span class="op">=</span>Tn<span class="op">*</span>T</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        Poly<span class="op">=</span>Poly<span class="op">*</span>A[i]<span class="op">*</span>Tn</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">1.0</span><span class="op">-</span>Poly<span class="op">*</span>exp(<span class="op">-</span>t<span class="op">*</span>t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>VH <span class="op">=</span> zeros((dim,dim))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>VHe <span class="op">=</span> zeros((dim,dim))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> q <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">=</span> alphas[p]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        nu <span class="op">=</span> alphas[q]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        N<span class="op">=</span>(<span class="dv">4</span><span class="op">*</span>mu<span class="op">*</span>nu<span class="op">/</span>(pi<span class="op">**</span><span class="dv">2</span>))<span class="op">**</span><span class="fl">0.75</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p<span class="op">==</span>q:</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            RpH<span class="op">=</span> rR1</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>            RpHe<span class="op">=</span> rR2</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>            VH[p,q] <span class="op">=</span>  <span class="op">-</span>ZH<span class="op">*</span>N<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span>(mu<span class="op">+</span>nu)<span class="op">*</span>F0((mu<span class="op">+</span>nu)<span class="op">*</span>((RpH<span class="op">-</span>rR1)<span class="op">**</span><span class="dv">2</span>))<span class="op">*</span>exp(<span class="op">-</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR1<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(mu<span class="op">+</span>nu))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>            VHe[p,q]<span class="op">=</span> <span class="op">-</span>ZHe<span class="op">*</span>N<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span>(mu<span class="op">+</span>nu)<span class="op">*</span>F0((mu<span class="op">+</span>nu)<span class="op">*</span>((RpHe<span class="op">-</span>rR2)<span class="op">**</span><span class="dv">2</span>))<span class="op">*</span>exp(<span class="op">-</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR1<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(mu<span class="op">+</span>nu))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            Rp<span class="op">=</span>(rR1<span class="op">*</span>αH<span class="op">+</span>rR2<span class="op">*</span>αHe)<span class="op">/</span>(αH<span class="op">+</span>αHe)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>            VH[p,q] <span class="op">=</span>  <span class="op">-</span>ZH<span class="op">*</span>N<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span>(mu<span class="op">+</span>nu)<span class="op">*</span>F0((mu<span class="op">+</span>nu)<span class="op">*</span>((Rp<span class="op">-</span>rR1)<span class="op">**</span><span class="dv">2</span>))<span class="op">*</span>exp(<span class="op">-</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR2<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(mu<span class="op">+</span>nu))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            VHe[p,q]<span class="op">=</span> <span class="op">-</span>ZHe<span class="op">*</span>N<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span>(mu<span class="op">+</span>nu)<span class="op">*</span>F0((mu<span class="op">+</span>nu)<span class="op">*</span>((Rp<span class="op">-</span>rR2)<span class="op">**</span><span class="dv">2</span>))<span class="op">*</span>exp(<span class="op">-</span>mu<span class="op">*</span>nu<span class="op">*</span>(rR2<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(mu<span class="op">+</span>nu))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(VH)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(VHe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[-1.02998213 -0.51029092]
 [-0.51029092 -1.40382341]]
[[-2.05996426 -1.88085068]
 [-1.88085068 -2.80764682]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Hcore <span class="op">=</span> T <span class="op">+</span> VH <span class="op">+</span> VHe </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Hcore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[-2.46504639 -2.15168972]
 [-2.15168972 -3.05062023]]</code></pre>
</div>
</div>
</section>
</section>
<section id="integrales-de-2-electrones-vee_mu-nu-sigma-lambda" class="level4" data-number="2.0.2.3">
<h4 data-number="2.0.2.3" class="anchored" data-anchor-id="integrales-de-2-electrones-vee_mu-nu-sigma-lambda"><span class="header-section-number">2.0.2.3</span> Integrales de 2 electrones <span class="math inline">\(V^{ee}_{\mu \nu \sigma \lambda}\)</span></h4>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Integrales de dos electrones reportadas en [3]</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Vee <span class="op">=</span> zeros((dim,dim,dim,dim))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Vee[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>]<span class="op">=</span> <span class="fl">0.7283</span> <span class="co">#A</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Vee[<span class="dv">1</span>][<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>]<span class="op">=</span> Vee[<span class="dv">0</span>][<span class="dv">1</span>][<span class="dv">0</span>][<span class="dv">0</span>]<span class="op">=</span> Vee[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">1</span>][<span class="dv">0</span>]<span class="op">=</span> Vee[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">1</span>]<span class="op">=</span> <span class="fl">0.3418</span> <span class="co">#B</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>Vee[<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">0</span>][<span class="dv">0</span>]<span class="op">=</span> Vee[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">=</span> <span class="fl">0.5850</span> <span class="co">#C</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>Vee[<span class="dv">1</span>][<span class="dv">0</span>][<span class="dv">1</span>][<span class="dv">0</span>]<span class="op">=</span> Vee[<span class="dv">0</span>][<span class="dv">1</span>][<span class="dv">0</span>][<span class="dv">1</span>]<span class="op">=</span> <span class="fl">0.2192</span> <span class="co">#D</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>Vee[<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">0</span>]<span class="op">=</span> Vee[<span class="dv">0</span>][<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">=</span> Vee[<span class="dv">1</span>][<span class="dv">0</span>][<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">=</span> Vee[<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">0</span>][<span class="dv">1</span>]<span class="op">=</span> <span class="fl">0.4368</span> <span class="co">#E</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>Vee[<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">=</span> <span class="fl">0.9927</span> <span class="co">#F</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ya que <span class="math inline">\(S_{\mu\nu}\)</span> es hermítica, esta puede diagonalizarse. Esto permitirá resolve la ecuación de Roothan dejando fuera la matriz de traslape.</p>
<p><span class="math inline">\(\textbf{F}\textbf{C}=\textbf{S}\textbf{C}\pmb{\epsilon} \rightarrow \textbf{F}'\textbf{C}'=\textbf{C}'\pmb{\epsilon}\)</span></p>
<p>donde <span class="math inline">\(\textbf{F}' = \textbf{X}^{\dagger}\textbf{F}\textbf{X}\)</span> y <span class="math inline">\(\textbf{X}=\textbf{S}^{1/2}\)</span></p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtención de la matriz X</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>eigvalS,U <span class="op">=</span> linalg.eig(S)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>diagS <span class="op">=</span> dot(U.T,dot(S,U))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>diagsqrtS <span class="op">=</span> diag(diagonal(diagS)<span class="op">**</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dot(U,dot(diagsqrtS,U.T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="calcular-matriz-de-fock-textbff" class="level3" data-number="2.0.3">
<h3 data-number="2.0.3" class="anchored" data-anchor-id="calcular-matriz-de-fock-textbff"><span class="header-section-number">2.0.3</span> Calcular matriz de Fock <span class="math inline">\(\textbf{F}\)</span></h3>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Proponer C_i para construcción de P</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Construir la matriz de densidad P a partir de C</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>C0 <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>P0 <span class="op">=</span> zeros((dim,dim))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> q <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        P0[p,q] <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>C0[p]<span class="op">*</span>C0[q]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(C0)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(P0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 0]
[[0. 0.]
 [0. 0.]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcular G0</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>G011<span class="op">=</span>[]<span class="op">;</span> G022<span class="op">=</span>[]<span class="op">;</span> G012<span class="op">=</span>[]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> m <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        g11 <span class="op">=</span> P0[n][m]<span class="op">*</span>(Vee[<span class="dv">0</span>][<span class="dv">0</span>][n][m]<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>Vee[<span class="dv">0</span>][m][n][<span class="dv">0</span>])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        g22 <span class="op">=</span> P0[n][m]<span class="op">*</span>(Vee[<span class="dv">1</span>][<span class="dv">1</span>][n][m]<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>Vee[<span class="dv">1</span>][m][n][<span class="dv">1</span>])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        g12 <span class="op">=</span> P0[n][m]<span class="op">*</span>(Vee[<span class="dv">0</span>][<span class="dv">1</span>][n][m]<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>Vee[<span class="dv">0</span>][m][n][<span class="dv">1</span>])</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        G011.append(g11)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        G022.append(g22)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        G012.append(g12)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        G021 <span class="op">=</span> G012</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>G0 <span class="op">=</span> [[<span class="bu">sum</span>(G011),<span class="bu">sum</span>(G012)],[<span class="bu">sum</span>(G021),<span class="bu">sum</span>(G022)]]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>G0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>[[0.0, 0.0], [0.0, 0.0]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>F0 <span class="op">=</span> Hcore <span class="op">+</span> G0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transformar-textbff-a-matriz-textbff" class="level3" data-number="2.0.4">
<h3 data-number="2.0.4" class="anchored" data-anchor-id="transformar-textbff-a-matriz-textbff"><span class="header-section-number">2.0.4</span> Transformar <span class="math inline">\(\textbf{F}\)</span> a matriz <span class="math inline">\(\textbf{F}'\)</span></h3>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>F0p <span class="op">=</span> X<span class="op">*</span>F0<span class="op">*</span>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="diagonalizar-matriz-textbff-para-obtener-pmbepsilon-y-textbfc" class="level3" data-number="2.0.5">
<h3 data-number="2.0.5" class="anchored" data-anchor-id="diagonalizar-matriz-textbff-para-obtener-pmbepsilon-y-textbfc"><span class="header-section-number">2.0.5</span> Diagonalizar matriz <span class="math inline">\(\textbf{F}'\)</span> para obtener <span class="math inline">\(\pmb{\epsilon}\)</span> y <span class="math inline">\(\textbf{C}'\)</span></h3>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>eigvalF0p,eigvecF0p <span class="op">=</span> linalg.eig(F0p)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ϵ <span class="op">=</span> diag(eigvalF0p)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Cp <span class="op">=</span> eigvecF0p.T</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>Cpm1<span class="op">=</span>inv(Cp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transformar-textbfc-a-textbfc" class="level3" data-number="2.0.6">
<h3 data-number="2.0.6" class="anchored" data-anchor-id="transformar-textbfc-a-textbfc"><span class="header-section-number">2.0.6</span> Transformar <span class="math inline">\(\textbf{C}'\)</span> a <span class="math inline">\(\textbf{C}\)</span></h3>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> X<span class="op">*</span>Cp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparar-parámetros-para-revisar-convergencia" class="level3" data-number="2.0.7">
<h3 data-number="2.0.7" class="anchored" data-anchor-id="comparar-parámetros-para-revisar-convergencia"><span class="header-section-number">2.0.7</span> Comparar parámetros para revisar convergencia</h3>
<p>A partir del paso 4, el procedimiento anterior se simplifica en un loop para buscar la convergencia:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.0003</span> <span class="co">#parámetro para convergencia</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>maxit <span class="op">=</span> <span class="dv">100</span> <span class="co">#máximo número de iteraciones</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Cs <span class="op">=</span> []</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Cs.append([[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]])</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>Es<span class="op">=</span>[]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(maxit):</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print('Iteración',n)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> zeros((dim,dim))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> q <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>            P[p,q] <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>Cs[i][<span class="dv">0</span>][p]<span class="op">*</span>Cs[i][<span class="dv">1</span>][q]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    G11<span class="op">=</span>[]<span class="op">;</span> G22<span class="op">=</span>[]<span class="op">;</span> G12<span class="op">=</span>[]</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> m <span class="kw">in</span> arange(<span class="dv">0</span>,dim):</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            g11 <span class="op">=</span> P[n][m]<span class="op">*</span>(Vee[<span class="dv">0</span>][<span class="dv">0</span>][n][m]<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>Vee[<span class="dv">0</span>][m][n][<span class="dv">0</span>])</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>            g22 <span class="op">=</span> P[n][m]<span class="op">*</span>(Vee[<span class="dv">1</span>][<span class="dv">1</span>][n][m]<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>Vee[<span class="dv">1</span>][m][n][<span class="dv">1</span>])</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>            g12 <span class="op">=</span> P[n][m]<span class="op">*</span>(Vee[<span class="dv">0</span>][<span class="dv">1</span>][n][m]<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>Vee[<span class="dv">0</span>][m][n][<span class="dv">1</span>])</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>            G11.append(g11)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>            G22.append(g22)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>            G12.append(g12)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    G21 <span class="op">=</span> G12</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> [[<span class="bu">sum</span>(G11),<span class="bu">sum</span>(G12)],[<span class="bu">sum</span>(G21),<span class="bu">sum</span>(G22)]]</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> Hcore <span class="op">+</span> G</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    Fp <span class="op">=</span> X<span class="op">*</span>F<span class="op">*</span>X</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    eigvalFp,eigvecFp <span class="op">=</span> linalg.eig(Fp)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> diag(eigvalFp)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    Cp <span class="op">=</span> eigvecFp.T</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    Cpm1<span class="op">=</span>inv(Cp)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    Ci <span class="op">=</span> X<span class="op">*</span>Cp</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    Cs.append(Ci)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    E <span class="op">=</span> trace(ϵ <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>(P<span class="op">*</span>Hcore))</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    Es.append(E)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    diff<span class="op">=</span><span class="bu">abs</span>(Es[i]<span class="op">-</span>Es[i<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">1</span> <span class="kw">and</span> diff<span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'done'</span>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'EHF ='</span>,E)</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>done
EHF = -5.758039504430062</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./DFT.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Teoría de los funcionales de la densidad (DFT)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>